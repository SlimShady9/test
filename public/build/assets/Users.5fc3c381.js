import{u as M,r as m,a as C,j as o,F as E,L as z}from"./app.931c200f.js";import{C as _}from"./Container.4e2431ad.js";import{Q as H,A as $}from"./Authenticated.18146c17.js";import{a as O}from"./index.9b570c6c.js";import{d as G}from"./index.esm.cc6f83de.js";import{G as P}from"./iconBase.84604709.js";import{B as A}from"./ButtonGroup.1a831fcb.js";import{M as Q}from"./Modal.8de470a5.js";import{I as R}from"./Input.d70bee13.js";import{S as k}from"./SelectInput.3299db13.js";import{B as I}from"./Button.4b2c6f6a.js";import{L as J}from"./Label.f31a5637.js";import{R as K}from"./react-loading.eb33551e.js";import{Q as W}from"./index.es.a7932b73.js";import{t as X}from"./TipoDocumentoEnum.2f13d358.js";import{t as Y}from"./TipoDeUsuariosEnum.c0dd3777.js";import{a as Z,i as q}from"./FetchUsers.f82384b8.js";import"./transportes.87cfd211.js";import"./Card.5e0dce84.js";import"./hoist-non-react-statics.cjs.13665392.js";function ee(l){return P({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"}}]}]})(l)}function te({parameters:l=[],onSubmit:c,titleForm:p,buttonText:v,cols:g,className:N}){const{data:s,setData:h,processing:b,errors:L,reset:j}=M(l.map(r=>({...r,value:r.value||""}))),[x,f]=m.exports.useState(!1),S=(r,u,i)=>{r.label?(h(t=>{const e=t.find(n=>n.name==i),a=t.findIndex(n=>n.name==i);return e.value={name:r.label,value:r.value},t[a]=e,t}),u({label:r.label,value:r.value})):(h(t=>{const e=t.find(n=>n.name==r.target.name),a=t.findIndex(n=>n.name==r.target.name);return e.value=r.target.value,t[a]=e,t}),u(r.target.value))};return C("form",{onSubmit:r=>{r.preventDefault(),f(!0);const u=Object.keys(s).map(t=>s[t].type=="select"?{[s[t].name]:s[t].value.value||s[t].value[0].value}:s[t].type=="text"?{[s[t].name]:s[t].value}:s[t]),i={};u.map(t=>{isNaN(Object.keys(t)[0])&&(i[Object.keys(t)[0]]=Object.values(t)[0])}),c(i)},children:[l.map(({label:r,extend:u,name:i,type:t,value:e,required:a,options:n,onlyLetters:d,alpaNumeric:U,onlyNumbers:w,email:B,min:T,max:V,minLenght:y,maxLenght:F})=>o(ae,{label:r,extend:u,name:i,type:t,value:e,required:a,options:n,handleChange:S,onlyLetters:d,alpaNumeric:U,onlyNumbers:w,email:B,min:T,max:V,minLenght:y,maxLenght:F},`${r}_${i}`)),C("div",{className:"flex col-span-2 justify-center m-4",children:[o("br",{}),C(I,{className:"justify-center ",processing:b,children:[x&&o(K,{type:"spin",color:"#808080",height:16,width:16}),!x&&v]})]})]})}function ae({label:l,extend:c,name:p,type:v,value:g,required:N,options:s,handleChange:h,onlyLetters:b,alpaNumeric:L,onlyNumbers:j,email:x,min:f,max:S,minLenght:D,maxLenght:r}){const[u,i]=m.exports.useState(g);return C("div",{className:"col-span-"+c,children:[o(J,{forInput:p,value:l}),v==="select"?o(k,{options:s,value:u,onChange:t=>h(t,i,p),required:N}):o(R,{type:v,name:p,defaultValue:u,autoComplete:p,handleChange:t=>h(t,i,p),required:N,onlyLetters:b,alpaNumeric:L,onlyNumbers:j,email:x,min:f,max:S,minLength:D,maxLength:r})]})}const re=({lUser:l})=>{const[c,p]=m.exports.useState(""),[v,g]=m.exports.useState([]),[N,s]=m.exports.useState([]),[h,b]=m.exports.useState(null),[L,j]=m.exports.useState([]),[x,f]=m.exports.useState(""),S=()=>f(!1),D=e=>{O.put(`/api/user/${h}`,e).then(a=>{g(n=>n.map(d=>d.id===a.data.id?a.data:d)),s(n=>n.map(d=>d.id===a.data.id?a.data:d)),b(null),f(!1)})},r=async()=>{try{const e=await Z({state:1});g(e.data.filter(a=>l.id!==a.id)),s(e.data.filter(a=>l.id!==a.id))}catch(e){console.log(e)}},u=e=>{q(e).then(a=>{const[n,d]=a;if(d){H.error("No se pudo inactivar el usuario. Contacte al administrador");return}H.success("Usuario inactivado correctamente"),g(U=>U.filter(w=>w.id!==n.id)),s(U=>U.filter(w=>w.id!==n.id))})},i=[{name:"Nombre de usuario",selector:e=>e.username},{name:"Nombres",selector:e=>e.name+" "+e.surname,sortable:!0},{name:"Tipo de usuario",selector:e=>Y(e.id_t_user)},{name:"Correo",selector:e=>o("a",{href:"http://"+e.email,target:"_blank",className:"bg-blue",children:e.email})},{name:"Documento",selector:e=>X(e.id_t_user)+" "+e.doc},{name:"Celular",selector:e=>e.cellphone},{name:"Tel\xE9fono",selector:e=>e.phone},{name:"Opciones",grow:1.5,center:!0,cell:e=>o(A,{listButtons:[{onClick:()=>t(e.id),icon:o(G,{}),text:"Editar",className:"bg-blue-400"},{onClick:()=>u(e),icon:o(ee,{}),text:"Inactivar"}]})}];m.exports.useEffect(()=>{r()},[]);const t=e=>{O.get(`/api/user/${e}/edit`).then(a=>{j(a.data.parameters),f(!0),b(e)})};return m.exports.useEffect(()=>{const e=v.filter(a=>a.username.toLowerCase().match(c.toLowerCase())||a.surname.toLowerCase().match(c.toLowerCase())||a.phone.match(c)||a.cellphone.match(c)||a.doc.match(c)||a.email.toLowerCase().match(c.toLowerCase()));s(e)},[c]),o(W,{columns:i,data:N,highlightOnHover:!0,fixedHeader:!0,pagination:!0,subHeader:!0,noDataComponent:"No se encontraron resultados",paginationComponentOptions:{rowsPerPageText:"Filas por p\xE1gina",rangeSeparatorText:"de"},subHeaderComponent:C(E,{children:[o(z,{href:"regUser",className:"p-3 bg-blue-400",children:o(I,{children:"Nuevo Usuario"})}),o("input",{type:"text",placeholder:"Buscar",className:"w-25 form-control rounded-3xl",value:c,onChange:e=>p(e.target.value)}),o(Q,{onHide:S,show:x,title:"Editar usuario",children:o(te,{parameters:L,buttonText:"Editar usuario",onSubmit:D})})]})})};var oe=re;function Le(l){return m.exports.useState([]),o(E,{children:o($,{...l,children:C(_,{className:"justify-center bg-opacity-30 shadow-xl flex flex-col ",children:[o("h1",{className:"text-blue-primary text-3xl mb-1 font-bold  text-center hover:scale-110 ease-in duration-200",children:"Tabla de Usuarios"}),o(oe,{lUser:l.auth.user})]})})})}export{Le as default};

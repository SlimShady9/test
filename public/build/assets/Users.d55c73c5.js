import{u as z,r as m,a as S,j as r,F as B,L as A}from"./app.63c72a0b.js";import{C as _}from"./Container.f909ca93.js";import{Q as M,A as $}from"./Authenticated.5cfa87ed.js";import{a as T}from"./index.d8622dc5.js";import{e as k}from"./index.esm.f53e7565.js";import{G}from"./iconBase.ee84b57b.js";import{B as P}from"./ButtonGroup.6e41d078.js";import{M as R}from"./Modal.689f95c3.js";import{I as Q}from"./Input.3a5f2bfd.js";import{S as J}from"./SelectInput.da6c27ea.js";import{B as V}from"./Button.f7308e50.js";import{L as K}from"./Label.523c14dd.js";import{R as W}from"./react-loading.03ececfd.js";import{Q as X}from"./index.es.a5d83e5d.js";import{t as Y}from"./TipoDocumentoEnum.8b38b97d.js";import{t as Z}from"./TipoDeUsuariosEnum.fd1e81a1.js";import{a as q,i as ee}from"./FetchUsers.9f9b20fb.js";import"./transportes.87cfd211.js";import"./Card.3e569932.js";import"./hoist-non-react-statics.cjs.13665392.js";function te(c){return G({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"}}]}]})(c)}function ae({parameters:c=[],onSubmit:u,titleForm:f,buttonText:U,cols:w,className:v}){const{data:n,setData:g,processing:j,errors:L,reset:O}=z(c.map(o=>({...o,value:o.value||""}))),[E,b]=m.exports.useState(!1),D=(o,d,l)=>{o.label?(g(a=>{const h=a.find(p=>p.name==l),C=a.findIndex(p=>p.name==l);return h.value={name:o.label,value:o.value},a[C]=h,a}),d({label:o.label,value:o.value})):(g(a=>{const h=a.find(p=>p.name==o.target.name),C=a.findIndex(p=>p.name==o.target.name);return h.value=o.target.value,a[C]=h,a}),d(o.target.value))};return S("form",{onSubmit:o=>{o.preventDefault(),b(!0);const d=Object.keys(n).map(a=>n[a].type=="select"?{[n[a].name]:n[a].value.value||n[a].value[0].value}:n[a].type=="text"?{[n[a].name]:n[a].value}:n[a]),l={};d.map(a=>{isNaN(Object.keys(a)[0])&&(l[Object.keys(a)[0]]=Object.values(a)[0])}),u(l)},children:[c.map(({label:o,extend:d,name:l,type:a,value:h,required:C,options:p,onlyLetters:y,alpaNumeric:e,onlyNumbers:t,email:s,min:i,max:x,minLenght:N,maxLenght:I})=>r(re,{label:o,extend:d,name:l,type:a,value:h,required:C,options:p,handleChange:D,onlyLetters:y,alpaNumeric:e,onlyNumbers:t,email:s,min:i,max:x,minLenght:N,maxLenght:I},`${o}_${l}`)),S("div",{className:"flex col-span-2 justify-center m-4",children:[r("br",{}),S(V,{className:"justify-center ",processing:j,children:[E&&r(W,{type:"spin",color:"#808080",height:16,width:16}),!E&&U]})]})]})}function re({label:c,extend:u,name:f,type:U,value:w,required:v,options:n,handleChange:g,onlyLetters:j,alpaNumeric:L,onlyNumbers:O,email:E,min:b,max:D,minLenght:H,maxLenght:o}){const[d,l]=m.exports.useState(w);return S("div",{className:"col-span-"+u,children:[r(K,{forInput:f,value:c}),U==="select"?r(J,{options:n,value:d,onChange:a=>g(a,l,f),required:v}):r(Q,{type:U,name:f,defaultValue:d,autoComplete:f,handleChange:a=>g(a,l,f),required:v,onlyLetters:j,alpaNumeric:L,onlyNumbers:O,email:E,min:b,max:D,minLength:H,maxLength:o})]})}const oe=({lUser:c})=>{const[u,f]=m.exports.useState(""),[U,w]=m.exports.useState([]),[v,n]=m.exports.useState([]),[g,j]=m.exports.useState(null),[L,O]=m.exports.useState([]),[E,b]=m.exports.useState(""),D=()=>b(!1),H=e=>{T.put(`/api/user/${g}`,e).then(t=>{w(s=>s.map(i=>i.id===t.data.id?t.data:i)),n(s=>s.map(i=>i.id===t.data.id?t.data:i)),j(null),b(!1)})},o=async()=>{try{const e=await q({state:1});w(e.data.filter(t=>c.id!==t.id)),n(e.data.filter(t=>c.id!==t.id))}catch(e){console.log(e)}},d=e=>{ee(e).then(t=>{const[s,i]=t;if(i){M.error("No se pudo inactivar el usuario. Contacte al administrador");return}M.success("Usuario inactivado correctamente"),w(x=>x.filter(N=>N.id!==s.id)),n(x=>x.filter(N=>N.id!==s.id))})};function l(e){let t;console.log(v);const s=",",i=`
`,x=Object.keys(v[0]);return t="",t+=x.join(s),t+=i,e.forEach(N=>{let I=0;x.forEach(F=>{I>0&&(t+=s),t+=N[F],I++}),t+=i}),t}function a(e){const t=document.createElement("a");let s=l(e);if(s==null)return;const i="export.csv";s.match(/^data:text\/csv/i)||(s=`data:text/csv;charset=utf-8,${s}`),t.setAttribute("href",encodeURI(s)),t.setAttribute("download",i),t.click()}const h=({onExport:e})=>r(V,{onClick:t=>e(t.target.value),children:"Export"}),C=[{name:"Usuario / Opciones",grow:2.5,center:!0,cell:e=>S("div",{className:"grid",children:[r("div",{className:"text-center text-lg font-bold",children:e.username}),r("div",{className:"mx-auto",children:r(P,{listButtons:[{onClick:()=>p(e.id),icon:r(k,{}),text:"Editar",className:"bg-blue-400"},{onClick:()=>d(e),icon:r(te,{}),text:"Inactivar"}]})})]})},{name:"Nombres",selector:e=>e.name+" "+e.surname,sortable:!0},{name:"Tipo de usuario",selector:e=>Z(e.id_t_user)},{name:"Correo",selector:e=>r("a",{href:"http://"+e.email,target:"_blank",className:"bg-blue",children:e.email})},{name:"Documento",selector:e=>Y(e.id_t_user)+" "+e.doc},{name:"Celular",selector:e=>e.cellphone},{name:"Tel\xE9fono",selector:e=>e.phone}];m.exports.useEffect(()=>{o()},[]);const p=e=>{T.get(`/api/user/${e}/edit`).then(t=>{O(t.data.parameters),b(!0),j(e)})};m.exports.useEffect(()=>{const e=U.filter(t=>t.username.toLowerCase().match(u.toLowerCase())||t.surname.toLowerCase().match(u.toLowerCase())||t.phone.match(u)||t.cellphone.match(u)||t.doc.match(u)||t.email.toLowerCase().match(u.toLowerCase()));n(e)},[u]);const y=m.exports.useMemo(()=>r(h,{onExport:()=>a(v)}),[]);return r(X,{columns:C,data:v,actions:y,highlightOnHover:!0,fixedHeader:!0,pagination:!0,subHeader:!0,noDataComponent:"No se encontraron resultados",paginationComponentOptions:{rowsPerPageText:"Filas por p\xE1gina",rangeSeparatorText:"de"},subHeaderComponent:S(B,{children:[r(A,{href:"regUser",className:"mx-auto p-3 bg-blue-400",children:r(V,{children:"Nuevo Usuario"})}),r("input",{type:"text",placeholder:"Buscar",className:"w-25 form-control rounded-3xl",value:u,onChange:e=>f(e.target.value)}),r(R,{onHide:D,show:E,title:"Editar usuario",children:r(ae,{parameters:L,buttonText:"Editar usuario",onSubmit:H})})]})})};var se=oe;function Ee(c){return m.exports.useState([]),r(B,{children:r($,{...c,children:S(_,{className:"justify-center bg-opacity-30 shadow-xl flex flex-col ",children:[r("h1",{className:"text-blue-primary text-3xl mb-1 font-bold  text-center hover:scale-110 ease-in duration-200",children:"Tabla de Usuarios"}),r(se,{lUser:c.auth.user})]})})})}export{Ee as default};
